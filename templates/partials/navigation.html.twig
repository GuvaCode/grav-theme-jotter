{#
* Jotter is a Grav CMS theme | https://github.com/underr-ua/grav-theme-jotter
* Copyright 2017-2019 Andrii Burkatskyi aka underr
* Licensed under MIT | https://github.com/underr-ua/grav-theme-jotter/raw/master/LICENSE
#}


{% set dropdown = theme_config.navbar.dropdown %}
{% set icon = theme_config.navbar.icon %}

<nav id="main_nav" class="go-nav nav-expand-md {{ classes }}" data-class="nav-open">
    <a class="nav-toggle" data-id="main_nav" href="javascript:void(0);">
        <i class="i-menu" data-icon="i-cancel" aria-hidden="true"></i>
    </a>
    <div class="nav-header">
        <a href="{{ base_url == '' ? '/' : base_url }}">
            <span class="ml-1" id="brand-text">
                <i aria-hidden="true" class="i-globe"></i>
                {{ config.site.title|upper }}
            </span>
        </a>
    </div>
    <div class="nav-list">
        {% for page in pages.children.visible %}
            {% set page_menu %}
            {% if page.header.icon %}
                <i class="{{ page.header.icon }}"></i>
            {% endif %}

            {{ page.menu }}
            {% endset %}

            {% if not page.active %}
                <a class="nav-item" href="{{ page.url }}">
                    {{ page_menu }}
                </a>
            {% else %}
                <a class="nav-item active" href="{{ page.url }}" style="{{ active_color }}">
                    {{ page_menu }}
                </a>
                {# <span class="nav-item active" style="{{ active_color }}">{{ page_menu }}</span> #}
            {% endif %}
        {% endfor %}

        {% if theme_config.sidebar.search.enabled and page.url(true) != (base_url ~ config.plugins.simplesearch.route) %}
            {% set min_chars = config.get('plugins.simplesearch.min_query_length', 3) %}

            <div class="nav-item">
                <i class="i-search font-sm"></i>
                <div class="search-wrapper-nav">
                    <form name="search" data-simplesearch-form>
                        <input name="searchfield" class="search-input" type="text" {% if min_chars > 0 %} data-min="{{- min_chars -}}" {% endif %} required placeholder="{{"PLUGIN_SIMPLESEARCH.SEARCH_PLACEHOLDER"|t}}" value="{{ query }}" data-search-invalid="{{ "PLUGIN_SIMPLESEARCH.SEARCH_FIELD_MINIMUM_CHARACTERS"|t(min_chars)|raw }}" data-search-separator="{{ config.system.param_sep }}" data-search-input="{{ base_url }}{{ config.plugins.simplesearch.route == '@self' ? '' : (config.plugins.simplesearch.route == '/' ? '' : config.plugins.simplesearch.route) }}/query"/>
                        {% if config.plugins.simplesearch.display_button %}
                            <button type="submit" class="search-submit">
                                <img src="{{ url('plugin://simplesearch/assets/search.svg') }}"/>
                            </button>
                        {% endif %}
                    </form>
                </div>
            </div>
        {% endif %}
    </div>
</nav>
